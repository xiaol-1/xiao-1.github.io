(function(){"use strict";var t={5553:function(t,i,e){var s=e(6369),n=function(){var t=this,i=t._self._c;return i("div",[i("router-view")],1)},a=[],r={},l=r,o=e(1001),c=(0,o.Z)(l,n,a,!1,null,null,null),u=c.exports,h=e(2631),d=function(){var t=this,i=t._self._c;return i("div",[i("van-nav-bar",{attrs:{title:t.$route.meta.title,fixed:"",placeholder:""}}),i("router-view"),i("van-tabbar",{attrs:{route:"",placeholder:""}},[i("van-tabbar-item",{attrs:{to:"/layout/home",icon:"home-o"}},[t._v("首页")]),i("van-tabbar-item",{attrs:{to:"/layout/search",icon:"search"}},[t._v("搜索")])],1)],1)},f=[],p={name:"MyLayout",data(){return{}}},m=p,v=(0,o.Z)(m,d,f,!1,null,"b765fb48",null),y=v.exports,g=function(){var t=this,i=t._self._c;return i("div",{staticClass:"play"},[i("div",{staticClass:"song-bg",style:`background-image: url(${t.picUrl}?imageView&thumbnail=360y360&quality=75&tostatic=0);`}),i("div",{staticClass:"header"},[i("van-icon",{staticClass:"left-incon",attrs:{name:"arrow-left",size:"20"},on:{click:function(i){return t.$router.back()}}})],1),i("div",{staticClass:"song-wrapper"},[i("div",{staticClass:"song-turn ani",style:"animation-play-state:"+(t.playState?"running":"paused")},[i("div",{staticClass:"song-img"},[i("img",{staticStyle:{width:"100%"},attrs:{src:`${t.picUrl}?imageView&thumbnail=360y360&quality=75&tostatic=0`,alt:""}})])]),i("div",{staticClass:"start-box",on:{click:t.audioStart}},[i("span",{directives:[{name:"show",rawName:"v-show",value:!t.playState,expression:"!playState"}],staticClass:"song-start"})]),i("div",{staticClass:"song-msg"},[i("h2",{staticClass:"m-song-h2"},[i("span",{staticClass:"m-song-sname"},[t._v(t._s(t.songInfo.name)+"-"+t._s(t.songInfo&&t.songInfo.ar&&t.songInfo.ar[0].name))])]),i("div",{staticClass:"lrcContent"},[i("p",{staticClass:"lrc"},[t._v(t._s(t.curLyric))])])]),i("div",{staticClass:"needle",style:`transform: rotate(${t.needleDeg});`})]),i("audio",{ref:"audio",attrs:{preload:"true",src:`https://music.163.com/song/media/outer/url?id=${t.id}.mp3`}}),i("canvas")])},w=[],_=(e(3767),e(8585),e(8696),e(4161));const b=_.Z.create({baseURL:"http://music.zll.cool/"});b.interceptors.response.use((function(t){return t.data}),(function(t){return console.log("响应拦截器 失败 1号"),Promise.reject(t)}));var C=b;const x=t=>C({url:`/song/detail?ids=${t}`,method:"GET"}),S=t=>C({url:`/lyric?id=${t}`,method:"GET"});var $={name:"MyPlay",data(){return{playState:!1,id:this.$route.query.id,songInfo:"",lyric:{},curLyric:"",lastLy:""}},computed:{needleDeg(){return this.playState?"-7deg":"-38deg"},picUrl(){return this.songInfo&&this.songInfo.al&&this.songInfo.al.picUrl}},methods:{async getSong(){const t=await x(this.id);this.songInfo=t.songs[0];const i=await S(this.id),e=i.lrc.lyric;this.lyric=this._formatLyr(e),this.curLyric=this.lyric[0]},_formatLyr(t){let i=/\[.+?\]/g,e=t.match(i),s=t.split(/\[.+?\]/).slice(1),n={};return e.forEach(((t,i)=>{let e=60*t.split(":")[0].split("")[2],a="0"===t.split(":")[1].split(".")[0].split("")[0]?t.split(":")[1].split(".")[0].split("")[1]:t.split(":")[1].split(".")[0];n[e+Number(a)]=s[i]})),n},audioStart(){this.playState?this.$refs.audio.pause():this.$refs.audio.play(),this.playState=!this.playState},showLyric(){this.$refs.audio.ontimeupdate=()=>{let t=Math.floor(this.$refs.audio.currentTime);this.lyric[t]?(this.curLyric=this.lyric[t],this.lastLy=this.curLyric):this.curLyric=this.lastLy}},draw(){requestAnimationFrame(this.draw);const{width:t,height:i}=this.cvs;if(this.ctx.clearRect(0,0,t,i),!this.isInit)return;this.analyser.getByteFrequencyData(this.dataArray);const e=this.dataArray.length/2.5,s=t/e/2;this.ctx.fillStyle="#e0f9b5";for(let n=0;n<e;n++){const e=this.dataArray[n],a=e/255*i,r=n*s+t/2,l=t/2-(n+1)*s,o=i-a;this.ctx.fillRect(r,o,s-2,a),this.ctx.fillRect(l,o,s-2,a)}},play(){if(this.isInit)return;const t=this.audioCtx.createMediaElementSource(this.audio);this.analyser=this.audioCtx.createAnalyser(),this.analyser.fftSize=512,this.dataArray=new Uint8Array(this.analyser.frequencyBinCount),t.connect(this.analyser),this.analyser.connect(this.audioCtx.destination),this.isInit=!0}},mounted(){this.getSong(),this.showLyric(),this.audioCtx=new AudioContext,this.audio=document.querySelector("audio"),this.cvs=document.querySelector("canvas"),this.ctx=this.cvs.getContext("2d"),this.cvs.width=window.innerWidth*devicePixelRatio,this.cvs.height=window.innerHeight/2*devicePixelRatio,this.draw()},beforeDestroy(){this.$refs.audio.ontimeupdate=null}},k=$,Z=(0,o.Z)(k,g,w,!1,null,"55911a94",null),L=Z.exports,P=function(){var t=this,i=t._self._c;return i("div",[t._v(" no find 404 ")])},I=[],M={name:"MyMissing"},q=M,O=(0,o.Z)(q,P,I,!1,null,null,null),A=O.exports,j=function(){var t=this,i=t._self._c;return i("div",[i("div",{staticClass:"warp"},[i("div",{staticClass:"title"},[t._v("推荐歌单")]),i("van-grid",{attrs:{gutter:10,border:!1,"column-num":3}},t._l(t.list,(function(e){return i("van-grid-item",{key:e.id},[i("van-image",{attrs:{src:e.picUrl}}),i("div",{staticClass:"song_name"},[t._v(t._s(e.name))])],1)})),1)],1),i("div",{staticClass:"warp"},[i("div",{staticClass:"title"},[t._v("最新音乐")]),t._l(t.Newlist,(function(t){return i("MucisCell",{key:t.id,attrs:{title:t.name,label:`${t.song.artists[0].name} - ${t.name}`,id:t.id}})}))],2)])},T=[];function U(t){return C({url:"personalized",params:t})}function z(t){return C({url:"personalized/newsong",params:t})}var N=function(){var t=this,i=t._self._c;return i("van-cell",{attrs:{title:t.title,label:t.label,center:""},scopedSlots:t._u([{key:"right-icon",fn:function(){return[i("van-icon",{attrs:{name:"play-circle-o",size:"25"},on:{click:t.fn}})]},proxy:!0}])})},R=[],E=(e(7658),{props:{title:{type:String,required:!0},label:{type:String,required:!0},id:{type:Number,required:!0}},methods:{fn(){this.$router.push({name:"play",query:{id:this.id}})}}}),D=E,F=(0,o.Z)(D,N,R,!1,null,null,null),B=F.exports,G={name:"MyHome",data(){return{list:null,Newlist:null}},async created(){const t=await U({limit:6});this.list=t.result;const i=await z({limit:10});this.Newlist=i.result,console.log(i)},mounted(){},components:{MucisCell:B}},H=G,V=(0,o.Z)(H,j,T,!1,null,"16f1f78c",null),W=V.exports,J=function(){var t=this,i=t._self._c;return i("div",[i("van-search",{attrs:{placeholder:"请输入搜索关键词"},on:{input:t.func},model:{value:t.value,callback:function(i){t.value=i},expression:"value"}}),""==t.value?i("div",{staticClass:"search_wrap"},[i("div",{staticClass:"hot_title"},[t._v("热门搜索")]),i("div",{staticClass:"hot_name_wrap"},t._l(t.list,(function(e,s){return i("span",{key:s,staticClass:"hot_item",on:{click:function(i){return t.func(e.first)}}},[t._v(t._s(e.first))])})),0)]):i("div",{staticClass:"search_wrap"},[i("div",{staticClass:"hot_title"},[t._v("最佳匹配")]),t._l(t.songlist,(function(t){return i("MucisCell",{key:t.id,attrs:{title:t.name,center:"",label:`${t.ar[0].name}-${t.name}`,id:t.id}})}))],2)],1)},K=[];function Q(){return C({url:"/search/hot"})}function X(t){return C({url:"/cloudsearch",params:t})}var Y={name:"MySearch",data(){return{value:"",list:null,songlist:[],timerid:null}},async created(){const t=await Q();this.list=t.result.hots},methods:{async func(t){""!==t&&(this.value=t,clearInterval(this.timerid),this.timerid=setTimeout((async()=>{const i=await X({keywords:t,limit:10});this.songlist=i.result.songs}),500))}}},tt=Y,it=(0,o.Z)(tt,J,K,!1,null,"3d71728c",null),et=it.exports;s.ZP.use(h.ZP);const st=[{path:"/",redirect:"/layout/home"},{path:"/layout",name:"layout",component:y,children:[{path:"home",name:"home",component:W,meta:{title:"首页"}},{path:"search",name:"search",component:et,meta:{title:"搜索"}}]},{path:"/play/:id",name:"play",component:L},{path:"*",name:A,component:A}],nt=new h.ZP({routes:st});var at=nt,rt=e(3713);e(5110);s.ZP.component("MucisCell",B),s.ZP.use(rt.ZP),s.ZP.config.productionTip=!1,new s.ZP({router:at,render:t=>t(u)}).$mount("#app")}},i={};function e(s){var n=i[s];if(void 0!==n)return n.exports;var a=i[s]={exports:{}};return t[s].call(a.exports,a,a.exports,e),a.exports}e.m=t,function(){var t=[];e.O=function(i,s,n,a){if(!s){var r=1/0;for(u=0;u<t.length;u++){s=t[u][0],n=t[u][1],a=t[u][2];for(var l=!0,o=0;o<s.length;o++)(!1&a||r>=a)&&Object.keys(e.O).every((function(t){return e.O[t](s[o])}))?s.splice(o--,1):(l=!1,a<r&&(r=a));if(l){t.splice(u--,1);var c=n();void 0!==c&&(i=c)}}return i}a=a||0;for(var u=t.length;u>0&&t[u-1][2]>a;u--)t[u]=t[u-1];t[u]=[s,n,a]}}(),function(){e.n=function(t){var i=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(i,{a:i}),i}}(),function(){e.d=function(t,i){for(var s in i)e.o(i,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:i[s]})}}(),function(){e.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)}}(),function(){var t={143:0};e.O.j=function(i){return 0===t[i]};var i=function(i,s){var n,a,r=s[0],l=s[1],o=s[2],c=0;if(r.some((function(i){return 0!==t[i]}))){for(n in l)e.o(l,n)&&(e.m[n]=l[n]);if(o)var u=o(e)}for(i&&i(s);c<r.length;c++)a=r[c],e.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return e.O(u)},s=self["webpackChunkwymucis"]=self["webpackChunkwymucis"]||[];s.forEach(i.bind(null,0)),s.push=i.bind(null,s.push.bind(s))}();var s=e.O(void 0,[998],(function(){return e(5553)}));s=e.O(s)})();